<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Some Additional Serverspec Types - Jason Antman's Blog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://blog.jasonantman.com/2015/03/some-additional-serverspec-types/">

        <meta name="author" content="Jason Antman" />
        <meta name="keywords" content="serverspec,specinfra,testing,beaker,ruby,rspec,gem" />
        <meta name="description" content="Some additional types that I wrote for Serverspec" />

        <meta property="og:site_name" content="Jason Antman's Blog" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Some Additional Serverspec Types"/>
        <meta property="og:url" content="https://blog.jasonantman.com/2015/03/some-additional-serverspec-types/"/>
        <meta property="og:description" content="Some additional types that I wrote for Serverspec"/>
        <meta property="article:published_time" content="2015-03-14" />
            <meta property="article:section" content="Software" />
            <meta property="article:tag" content="serverspec" />
            <meta property="article:tag" content="specinfra" />
            <meta property="article:tag" content="testing" />
            <meta property="article:tag" content="beaker" />
            <meta property="article:tag" content="ruby" />
            <meta property="article:tag" content="rspec" />
            <meta property="article:tag" content="gem" />
            <meta property="article:author" content="Jason Antman" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://blog.jasonantman.com/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="https://blog.jasonantman.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://blog.jasonantman.com/theme/css/pygments/default.css" rel="stylesheet">
        <link href="https://blog.jasonantman.com/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="https://blog.jasonantman.com/theme/css/style.css" type="text/css"/>
        <link href="https://blog.jasonantman.com/theme/css/shariff/shariff.min.css" rel="stylesheet">

    <link rel="stylesheet" href="https://blog.jasonantman.com/theme/css/forkongithub.min.css" type="text/css" />

        <link href="https://blog.jasonantman.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Jason Antman's Blog ATOM Feed"/>

        <link href="https://blog.jasonantman.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate"
              title="Jason Antman's Blog RSS Feed"/>


        <link href="https://blog.jasonantman.com/feeds/categories/software.atom.xml" type="application/atom+xml" rel="alternate"
              title="Jason Antman's Blog Software ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
<span id="forkongithub"><a href="https://github.com/jantman/blog">Fork me on GitHub</a></span>        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://blog.jasonantman.com/" class="navbar-brand">
Jason Antman's Blog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/pages/about.html">About Me</a></li>
                    <li><a href="/categories/aws/index.html">AWS</a></li>
                    <li><a href="/categories/software/index.html">Software</a></li>
                    <li><a href="/categories/hardware/index.html">Hardware</a></li>
                    <li><a href="/categories/diy-home-automation-security/index.html">DIY / Home Automation / Security</a></li>
                    <li><a href="/categories/miscellaneous/index.html">Miscellaneous</a></li>
                    <li><a href="/tags.html">Tags</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://blog.jasonantman.com/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://blog.jasonantman.com/2015/03/some-additional-serverspec-types/"
                       rel="bookmark"
                       title="Permalink to Some Additional Serverspec Types">
                        Some Additional Serverspec&nbsp;Types
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-03-14T11:58:00-04:00"> Sat 14 March 2015</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://blog.jasonantman.com/tags/serverspec/index.html">serverspec</a>
        /
	<a href="https://blog.jasonantman.com/tags/specinfra/index.html">specinfra</a>
        /
	<a href="https://blog.jasonantman.com/tags/testing/index.html">testing</a>
        /
	<a href="https://blog.jasonantman.com/tags/beaker/index.html">beaker</a>
        /
	<a href="https://blog.jasonantman.com/tags/ruby/index.html">ruby</a>
        /
	<a href="https://blog.jasonantman.com/tags/rspec/index.html">rspec</a>
        /
	<a href="https://blog.jasonantman.com/tags/gem/index.html">gem</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p><a href="http://serverspec.org/">Serverspec</a> is an rspec-based framework for testing live machines,
and making assertions about things like the output of commands, installed packages, running
services, file content, etc. However, it has a relatively limited and basic set of
<a href="http://serverspec.org/resource_types.html">Resource Types</a> that it can test&nbsp;for.</p>
<p>Before Serverspec completely disabled their GitHub issue tracker (they now seem to have no
issue tracker at all), I&#8217;d suggested some improvements for more advanced resource types,
such as one that can perform an <span class="caps">HTTP</span> <span class="caps">GET</span> against an application and check the status code
and/or output. I was told in no uncertain terms that this is a task for application integration
testing, and that it&#8217;s &#8220;not what Serverspec is&nbsp;for.&#8221;</p>
<p>I humbly disagree. I&#8217;ve begun migrating my <a href="https://www.linode.com/">Linode</a> to an <span class="caps">EC2</span> machine,
using some technology that I&#8217;ve been using at my day job; specifically, Puppet to configure the
machine and <a href="https://packer.io/">Packer</a> to build an <span class="caps">AMI</span>. Instead of using <a href="http://aws.amazon.com/cloudformation/">Cloudformation</a>
to spin up an entire stack, I just use a Rakefile to spin up a new <span class="caps">EC2</span> instance, test it, and
swap an <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html">Elastic <span class="caps">IP</span></a>
if all the tests pass. Of course, this requires that I have relatively complete automated testing
of the <span class="caps">EC2</span> instance. Stock Serverspec can handle 95% of what I want to test, but there are a few
other, more complex, things that it can&#8217;t. So, I wrote some code to fix&nbsp;that.</p>
<p>I&#8217;ll admit right off the bat that this code doesn&#8217;t really work the way Serverspec is intended to,
but it works and it&#8217;s relatively simple. This largely breaks the abstraction of serverspec using
<a href="https://github.com/serverspec/specinfra">specinfra</a> under the hood, but I&#8217;m not sure if that&#8217;s even
a concern (since specinfra seems to be all about testing a running machine via some local command
execution mechanism, and two of the types that I wrote use network <span class="caps">IO</span>&nbsp;instead).</p>
<p>For the time being, I&#8217;ve written three additional <a href="http://www.rubydoc.info/gems/serverspec-extended-types/#Types">types</a>
that solve some specific use cases for&nbsp;me:</p>
<ul>
<li>A <a href="http://www.rubydoc.info/gems/serverspec-extended-types/#bitlbee">bitlbee</a>
type that connects to a <a href="http://www.bitlbee.org/">Bitlbee</a> <span class="caps">IRC</span> gateway, authenticates,
and checks the running bitlbee version. It has matchers to check whether or not the connection and
authentication was successful, whether or not it timed out, and the bitlbee version. Parameters for
the type include login nick and password, bitlbee port, and whether or not to connect with&nbsp;<span class="caps">SSL</span>.</li>
<li>A <a href="http://www.rubydoc.info/gems/serverspec-extended-types/#http_get">http_get</a>
type which connects to the system under test (with a specified port) and issues a
<span class="caps">HTTP</span> <span class="caps">GET</span> request for a specified path, with a specified <code>Host</code> header and a timeout (default
10 seconds). Matchers are provided for the response content body (string), response headers
(hash), <span class="caps">HTTP</span> status code, and whether or not the request timed out (which also sets a status of&nbsp;0).</li>
<li>A <a href="http://www.rubydoc.info/gems/serverspec-extended-types/#virtualenv">virtualenv</a> type for testing
python <a href="https://virtualenv.pypa.io/en/latest/">virtualenv</a>s. It takes the absolute path to the venv
on the filesystem, and uses serverspec&#8217;s built-in file and command execution features to ensure that
the path &#8220;looks like&#8221; a virtualenv, and has matchers for the pip and python versions used in the venv
as well as the <code>pip freeze</code> output as a hash of requirements and their&nbsp;versions.</li>
</ul>
<p>Hopefully this will be of use to someone else as well. As I continue using serverspec, I plan on
adding to the&nbsp;types.</p>
<p>The code for serverspec-extended-types is on <a href="https://github.com/jantman/serverspec-extended-types/tree/master">GitHub</a>
(pull requests and issues welcome) and it&#8217;s packaged and hosted as a <a href="https://rubygems.org/gems/serverspec-extended-types">ruby gem</a>.
<a href="http://www.rubydoc.info/gems/serverspec-extended-types/0.0.2#Installation">Installation</a> and usage is as simple
as adding it to your Gemfile and <a href="http://www.rubydoc.info/gems/serverspec-extended-types/0.0.2#Usage">spec_helper</a>
and then using the types and matchers in your&nbsp;specs.</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- Shariff Button BEGIN -->
    <div class="shariff"
        data-lang="en"
        data-orientation="horizontal"
        data-services = "[&quot;facebook&quot;,&quot;googleplus&quot;,&quot;twitter&quot;,&quot;linkedin&quot;,&quot;diaspora&quot;]"
        data-theme="standard"
        data-url="https://blog.jasonantman.com/2015/03/some-additional-serverspec-types/"></div>
    <!-- Shariff Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jantman'; // required: replace example with your forum shortname

                    var disqus_identifier = 'some-additional-serverspec-types';
                var disqus_url = 'https://blog.jasonantman.com/2015/03/some-additional-serverspec-types/';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="https://blog.jasonantman.com/2018/11/inexpensive-26USD-1080p-wifi-camera/">Inexpensive $<span class="caps">26USD</span> 1080p WiFi&nbsp;Camera</a></li>
    <li class="list-group-item"><a href="https://blog.jasonantman.com/2018/11/open-source-wifi-site-survey-tool/">Open Source WiFi Site Survey Heatmap&nbsp;Tool</a></li>
    <li class="list-group-item"><a href="https://blog.jasonantman.com/2018/08/home-automation-and-security-system-overview/">Home Automation and Security System&nbsp;Overview</a></li>
    <li class="list-group-item"><a href="https://blog.jasonantman.com/2018/07/better-logging-for-appdaemon-apps/">Better Logging for AppDaemon&nbsp;Apps</a></li>
    <li class="list-group-item"><a href="https://blog.jasonantman.com/2018/07/shamelessly-over-engineered-coax-lightning-protector/">Shamelessly Over-Engineered Coax Lightning&nbsp;Protector</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Twitter Timeline -->
<li class="list-group-item">
  <h4><i class="fa fa-twitter fa-lg"></i><span class="icon-label">Latest Tweets</span></h4>
  <div id="twitter_timeline">
    <a class="twitter-timeline" data-width="250" data-height="300" data-dnt="true" data-theme="light" href="https://twitter.com/j_antman">Tweets by j_antman</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</li>
<!-- End Sidebar/Twitter Timeline -->

<!-- Sidebar/Github -->
<li class="list-group-item">
  <h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
  <div id="gh_repos">
    <p class="list-group-item">Status updating...</p>
  </div>
  <a href="https://github.com/jantman">@jantman</a> on GitHub
</li>
<!-- End Sidebar/Github -->

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="http://www.jasonantman.com" target="_blank">Homepage</a>
    </li>
    <li class="list-group-item">
      <a href="http://resume.jasonantman.com" target="_blank">Resume</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Jason Antman
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://blog.jasonantman.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://blog.jasonantman.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://blog.jasonantman.com/theme/js/respond.min.js"></script>



    <!-- GITHUB_REPOS_JSON (explicitly pinned repos ) -->
  <script id="GithubReposJson" type="application/json">
  [{"description": "A script and python module to check your AWS service limits and usage via boto.", "name": "awslimitchecker", "html_url": "https://github.com/jantman/awslimitchecker"}, {"description": "Puppet module and accompanying documentation to install/setup Arch linux on a MacBook Pro Retina 11,4", "name": "puppet-archlinux-macbookretina", "html_url": "https://github.com/jantman/puppet-archlinux-macbookretina"}, {"description": "A collection of my standalone scripts to small/quick for their own repos. All kinds of useful stuff.", "name": "misc-scripts", "html_url": "https://github.com/jantman/misc-scripts"}, {"description": "Responsive Flask/SQLAlchemy personal finance app, specifically for biweekly budgeting.", "name": "biweeklybudget", "html_url": "https://github.com/jantman/biweeklybudget"}, {"description": "A standard to easily communicate to humans and machines the development/support and usability status of software repositories/projects.", "name": "repostatus.org", "html_url": "https://github.com/jantman/repostatus.org"}, {"description": "Python/selenium script to get Xfinity bandwidth usage", "name": "xfinity-usage", "html_url": "https://github.com/jantman/xfinity-usage"}]
  </script>

<!-- GitHub JS Code -->
<script type="text/javascript">
$(document).ready(function () {
  if (!window.jXHR) {
    var jxhr = document.createElement('script');
    jxhr.type = 'text/javascript';
    jxhr.src = 'https://blog.jasonantman.com/theme/js/jXHR.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(jxhr, s);
  }

  console.log($('#GithubReposJson').html());
  github.showSpecificRepos({
    user: 'jantman',
    target: '#gh_repos',
    repos: JSON.parse($('#GithubReposJson').html())
  });
});
</script>
<script src="https://blog.jasonantman.com/theme/js/github.js" type="text/javascript"></script>
<!-- End GitHub JS Code -->
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jantman'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics Universal -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-2718127-2', 'jasonantman.com');
        ga('send', 'pageview');
    </script>
    <!-- End Google Analytics Universal Code -->


    <!-- add shariff support -->
    <script src="https://blog.jasonantman.com/theme/js/shariff.min.js"></script>
</body>
</html>