<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Getting oVirt up and running - Jason Antman's Blog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://blog.jasonantman.com/2012/09/getting-ovirt-up-and-running/">

        <meta name="author" content="admin" />
        <meta name="keywords" content="fedora,kvm,ovirt,qemu,redhat,rhev,spice,virtualization" />
        <meta name="description" content="The bulk of this post was written way back in April 2012. If you’re just coming here, and looking to setup oVirt, you should probably skip down to the postscript for an update, and ignore most of the content here (as it’s applicable to an older oVirt version …" />

        <meta property="og:site_name" content="Jason Antman's Blog" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Getting oVirt up and running"/>
        <meta property="og:url" content="http://blog.jasonantman.com/2012/09/getting-ovirt-up-and-running/"/>
        <meta property="og:description" content="The bulk of this post was written way back in April 2012. If you’re just coming here, and looking to setup oVirt, you should probably skip down to the postscript for an update, and ignore most of the content here (as it’s applicable to an older oVirt version …"/>
        <meta property="article:published_time" content="2012-09-07" />
            <meta property="article:section" content="Tech HowTos" />
            <meta property="article:tag" content="fedora" />
            <meta property="article:tag" content="kvm" />
            <meta property="article:tag" content="ovirt" />
            <meta property="article:tag" content="qemu" />
            <meta property="article:tag" content="redhat" />
            <meta property="article:tag" content="rhev" />
            <meta property="article:tag" content="spice" />
            <meta property="article:tag" content="virtualization" />
            <meta property="article:author" content="admin" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.jasonantman.com/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="http://blog.jasonantman.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.jasonantman.com/theme/css/pygments/default.css" rel="stylesheet">
        <link href="http://blog.jasonantman.com/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.jasonantman.com/theme/css/style.css" type="text/css"/>
        <link href="http://blog.jasonantman.com/theme/css/shariff/shariff.min.css" rel="stylesheet">

    <link rel="stylesheet" href="http://blog.jasonantman.com/theme/css/forkongithub.min.css" type="text/css" />

        <link href="http://blog.jasonantman.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Jason Antman's Blog ATOM Feed"/>

        <link href="http://blog.jasonantman.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate"
              title="Jason Antman's Blog RSS Feed"/>


        <link href="http://blog.jasonantman.com/feeds/categories/tech-howtos.atom.xml" type="application/atom+xml" rel="alternate"
              title="Jason Antman's Blog Tech HowTos ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
<span id="forkongithub"><a href="https://github.com/jantman/blog">Fork me on GitHub</a></span>        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.jasonantman.com/" class="navbar-brand">
Jason Antman's Blog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://blog.jasonantman.com/pages/about.html">
                             About
                          </a></li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/ideas-and-rants/index.html">Ideas and rants</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/miscellaneous/index.html">Miscellaneous</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/monitoring/index.html">Monitoring</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/ops/index.html">Ops</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/projects/index.html">Projects</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/puppet/index.html">Puppet</a>
                        </li>
                        <li class="active">
                            <a href="http://blog.jasonantman.com/categories/tech-howtos/index.html">Tech howtos</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://blog.jasonantman.com/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.jasonantman.com/2012/09/getting-ovirt-up-and-running/"
                       rel="bookmark"
                       title="Permalink to Getting oVirt up and running">
                        Getting oVirt up and&nbsp;running
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2012-09-07T05:00:00-04:00"> Fri 07 September 2012</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="http://blog.jasonantman.com/tags/fedora/index.html">fedora</a>
        /
	<a href="http://blog.jasonantman.com/tags/kvm/index.html">kvm</a>
        /
	<a href="http://blog.jasonantman.com/tags/ovirt/index.html">ovirt</a>
        /
	<a href="http://blog.jasonantman.com/tags/qemu/index.html">qemu</a>
        /
	<a href="http://blog.jasonantman.com/tags/redhat/index.html">redhat</a>
        /
	<a href="http://blog.jasonantman.com/tags/rhev/index.html">rhev</a>
        /
	<a href="http://blog.jasonantman.com/tags/spice/index.html">spice</a>
        /
	<a href="http://blog.jasonantman.com/tags/virtualization/index.html">virtualization</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>The bulk of this post was written way back in April 2012. If you&#8217;re just
coming here, and looking to setup oVirt, you should probably <a href="#postscript">skip down
to the postscript</a> for an update, and ignore most of the
content here (as it&#8217;s applicable to an older oVirt&nbsp;version).</p>
<p>I recently started setting up <a href="http://www.ovirt.org">oVirt</a>, the
community version of Red Hat Enterprise Virtualization, at work for some
testing (mainly a &#8220;sandbox&#8221; <span class="caps">VM</span> environment, and because
<a href="http://theforeman.org/">Foreman</a>
<a href="http://blog.theforeman.org/2012/03/vnc-support-built-in-foreman.html">supports</a>
it). To start with, I had two nodes, each with two dual-core Xeon
processors (<span class="caps">VT</span>-x capable) with <span class="caps">20GB</span> <span class="caps">RAM</span>, one with <span class="caps">600GB</span> internal storage
and one with <span class="caps">140GB</span> internal. While oVirt&#8217;s documentation isn&#8217;t exactly
wonderful, I found a blgo post by Jason Brooks, <a href="http://blog.jebpages.com/archives/how-to-get-up-and-running-with-ovirt/">How to Get Up and
Running with
oVirt</a>,
which gives a great walkthrough of getting the oVirt Engine setup on a
machine, and also setting up that same machine as a <span class="caps">VM</span> host. As oVirt is
still fairly young, this is all done on Fedora. I performed my
installation via Cobbler, though I&#8217;m afraid to admit it was an entirely
manual, interactive&nbsp;install.</p>
<p>I did run into a few bumps during Jason&#8217;s tutorial. In step 15, adding
the data <span class="caps">NFS</span> export as a Storage Domain, I was unable to add the <span class="caps">NFS</span>
export. I found the <a href="http://www.ovirt.org/wiki/Troubleshooting_NFS_Storage_Issues">Troubleshooting <span class="caps">NFS</span> Storage Issues page on the
oVirt
wiki</a>,
ensured that SELinux was disabled and that the export had the correct
permissions, confirmed that <code>/etc/nfsmount.conf</code> specified <code>Nfsvers=3</code>,
rebooted, and then ran the <code>nfs-check.py</code> script. At this point, I was
able to add the other storage domains in steps 15 and&nbsp;16.</p>
<p>My second issue was that even on Fedora 16, I simply can&#8217;t get the spice
client (through the <code>spice-xpi</code> browser plugin) to work. As far as I can
tell from the logs, it looks like <code>spicec</code> is being sent a value of
&#8220;None&#8221; for the secured port parameter, instead of the correct port
number. I assume this is a bug in oVirt, but I&#8217;ll revisit this problem
when I have time. In the mean time, I changed my test <span class="caps">VM</span> to use <span class="caps">VNC</span>,
which is launched by installing the <code>ovirt-engine-cli</code> package (see
below) on your client computer, connecting to the oVirt <span class="caps">API</span> with&nbsp;ovirt-shell:  </p>
<p><code>ovirt-shell --connect --url=https://ovirt-engine.example.com:8443/api --user=admin@internal --password adminpassword</code><br>
and then running <code>console vm_name</code>. This launches the <code>vncviewer</code>
binary, which is in the &#8220;tigervnc&#8221; package on&nbsp;Fedora.</p>
<p><strong>Installing&nbsp;ovirt-engine-cli</strong></p>
<p>To run <code>ovirt-shell</code> on your workstation (Fedora 16, of course&#8230;)
you&#8217;ll need the ovirt-engine-cli and ovirt-engine-sdk packages. I
manually downloaded them from
<a href="http://www.ovirt.org/releases/nightly/fedora/16/">http://www.ovirt.org/releases/nightly/fedora/16/</a>,
versions 2.1.3 and 1.6.2, respecitively. The <span class="caps">SDK</span> and <span class="caps">CLI</span> are python
based, so there are a few Python dependencies, all of which were
automatically solved by yum. I know there are <span class="caps">SDK</span> and <span class="caps">CLI</span> packages out
there for other distros, but haven&#8217;t tried them&nbsp;yet.</p>
<p><strong>Installing Linux&nbsp;Guests</strong></p>
<p>Installing a CentOS 6.2 x86_64 guest was relatively straightforward,
and my usual kickstart infrastructure worked fine. The only catch was
the VirtIO storage interface, which shows up as <code>/dev/vdx</code> instead of
<code>/dev/sdx</code>; I just added another kickstart metadata option in Cobbler
that allows me to use <code>sdx</code> by specifying &#8220;virtual=yes&#8221; (for our VMWare
hosts), or <code>vdx</code> by specifying&nbsp;&#8220;virtual=ovirt&#8221;.</p>
<p><strong>Setting up&nbsp;Authentication</strong></p>
<p>As installed, oVirt only has one user, &#8220;admin@internal&#8221;; it requires an
external directory service for user authentication. Currently, it
supports <span class="caps">IPA</span>, Red Hat&#8217;s Enterprise Identity Management tool (combines
<span class="caps">RHEL</span>, oVirt Directory Server, Kerberos and <span class="caps">NTP</span>; perhaps
<a href="http://freeipa.org">FreeIPA</a> would work as well?) and Microsoft Active
Directory. As much as I&#8217;d like to give <span class="caps">IPA</span> or FreeIPA a try, my company
already has an <span class="caps">AD</span> infrastructure, so I opted to go that route.
Documentation is given in the <a href="http://www.ovirt.org/wiki/File:OVirt-3.0-Installation_Guide-en-US.pdf">oVirt 3.0 Installation
Guide</a>,
starting on page 96. Unfortunately, I was never about to get <span class="caps">AD</span> auth
working correctly, so I just worked with the one admin&nbsp;user.</p>
<p><strong>Adding a&nbsp;Node</strong></p>
<p>The biggest issue I had was adding the second node to oVirt. I attempted
to use the <span class="caps">DVD</span> Import feature of Cobbler on the <a href="http://www.ovirt.org/get-ovirt/">oVirt Node Image
<span class="caps">ISO</span></a>, but that failed. I then found the
image&#8217;s <code>LiveOS/livecd-iso-to-pxeboot</code> script and used that to make a
kernerl and initrd, and kernel parameters, for Cobbler. <span class="caps">PXE</span> works&nbsp;fine.</p>
<p><a name="postscript"></a><strong>Postscript:</strong> I ended up blowing away my
oVirt installation in favor of testing other things. At some point, the
engine install got corrupted in a way that I just couldn&#8217;t fix; even
though I spent all day one Saturday working on it, it took more time
than I could allocate to a personal project. So this post is really
semi-complete at best. However, there is some good news. Jason Brooks&#8217;
original post, <a href="http://blog.jebpages.com/archives/how-to-get-up-and-running-with-ovirt/">How to Get Up and Running with
oVirt</a>,
was written for oVirt 3.0, as was this post. Since then, there has been
a new release, <a href="http://wiki.ovirt.org/wiki/OVirt_3.1_release_notes">oVirt
3.1</a>, which
apparently has a better <span class="caps">UI</span> and a better installer. Jason Brooks has a
new post, <a href="http://blog.jebpages.com/archives/up-and-running-with-ovirt-3-1-edition/">Up and Running with oVirt, 3.1
Edition</a>,
which covers installation and configuration of both an all-in-one
machine and a separate node. If you&#8217;re looking to try oVirt, I&#8217;d
recommend you give that a shot. Unfortunately (and strangely, given that
this is supposed to be the &#8220;upstream&#8221; of RedHat&#8217;s proprietary <span class="caps">RHEV</span>) it&#8217;s
still all based on&nbsp;Fedora.</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- Shariff Button BEGIN -->
    <div class="shariff"
        data-lang="en"
        data-orientation="horizontal"
        data-services = "[&quot;facebook&quot;,&quot;googleplus&quot;,&quot;twitter&quot;,&quot;linkedin&quot;,&quot;diaspora&quot;]"
        data-theme="standard"
        data-url="http://blog.jasonantman.com/2012/09/getting-ovirt-up-and-running/"></div>
    <!-- Shariff Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jantman'; // required: replace example with your forum shortname

                    var disqus_identifier = 'getting-ovirt-up-and-running';
                var disqus_url = 'http://blog.jasonantman.com/2012/09/getting-ovirt-up-and-running/';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="http://blog.jasonantman.com/2017/10/cloud-custodian-architecture-deployment-and-policy-preprocessing/">Cloud Custodian Architecture, Deployment and Policy&nbsp;Preprocessing</a></li>
    <li class="list-group-item"><a href="http://blog.jasonantman.com/2017/10/pre-authorized-aws-console-urls-for-notifications/">Pre-Authorized <span class="caps">AWS</span> Console URLs for&nbsp;Notifications</a></li>
    <li class="list-group-item"><a href="http://blog.jasonantman.com/2017/04/python-script-to-check-xfinity-data-usage/">Python script to check xfinity data&nbsp;usage</a></li>
    <li class="list-group-item"><a href="http://blog.jasonantman.com/2017/03/vyos-on-alix-2c1-single-board-computer/">VyOS on Alix 2C1 Single Board&nbsp;Computer</a></li>
    <li class="list-group-item"><a href="http://blog.jasonantman.com/2016/10/yesterdays-widespread-internet-outage-for-non-geeks/">Yesterday&#8217;s Widespread Internet Outage, for&nbsp;non-geeks</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Twitter Timeline -->
<li class="list-group-item">
  <h4><i class="fa fa-twitter fa-lg"></i><span class="icon-label">Latest Tweets</span></h4>
  <div id="twitter_timeline">
    <a class="twitter-timeline" data-width="250" data-height="300" data-dnt="true" data-theme="light" href="https://twitter.com/j_antman">Tweets by j_antman</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</li>
<!-- End Sidebar/Twitter Timeline -->

<!-- Sidebar/Github -->
<li class="list-group-item">
  <h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
  <div id="gh_repos">
    <p class="list-group-item">Status updating...</p>
  </div>
  <a href="https://github.com/jantman">@jantman</a> on GitHub
</li>
<!-- End Sidebar/Github -->

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="http://www.jasonantman.com" target="_blank">Homepage</a>
    </li>
    <li class="list-group-item">
      <a href="http://resume.jasonantman.com" target="_blank">Resume</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2017 Jason Antman
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://blog.jasonantman.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.jasonantman.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.jasonantman.com/theme/js/respond.min.js"></script>



    <!-- GITHUB_REPOS_JSON (explicitly pinned repos ) -->
  <script id="GithubReposJson" type="application/json">
  [{"description": "A script and python module to check your AWS service limits and usage via boto.", "name": "awslimitchecker", "html_url": "https://github.com/jantman/awslimitchecker"}, {"description": "Puppet module and accompanying documentation to install/setup Arch linux on a MacBook Pro Retina 11,4", "name": "puppet-archlinux-macbookretina", "html_url": "https://github.com/jantman/puppet-archlinux-macbookretina"}, {"description": "A collection of scripts that I've written", "name": "misc-scripts", "html_url": "https://github.com/jantman/misc-scripts"}, {"description": "Responsive Flask/SQLAlchemy personal finance app, specifically for biweekly budgeting.", "name": "biweeklybudget", "html_url": "https://github.com/jantman/biweeklybudget"}, {"description": "Calculate detailed download stats and generate HTML and badges for PyPI packages", "name": "pypi-download-stats", "html_url": "https://github.com/jantman/pypi-download-stats"}, {"description": "A standard to easily communicate to humans and machines the development/support and usability status of software repositories/projects.", "name": "repostatus.org", "html_url": "https://github.com/jantman/repostatus.org"}]
  </script>

<!-- GitHub JS Code -->
<script type="text/javascript">
$(document).ready(function () {
  if (!window.jXHR) {
    var jxhr = document.createElement('script');
    jxhr.type = 'text/javascript';
    jxhr.src = 'http://blog.jasonantman.com/theme/js/jXHR.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(jxhr, s);
  }

  console.log($('#GithubReposJson').html());
  github.showSpecificRepos({
    user: 'jantman',
    target: '#gh_repos',
    repos: JSON.parse($('#GithubReposJson').html())
  });
});
</script>
<script src="http://blog.jasonantman.com/theme/js/github.js" type="text/javascript"></script>
<!-- End GitHub JS Code -->
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jantman'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics Universal -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-2718127-2', 'jasonantman.com');
        ga('send', 'pageview');
    </script>
    <!-- End Google Analytics Universal Code -->


    <!-- add shariff support -->
    <script src="http://blog.jasonantman.com/theme/js/shariff.min.js"></script>
</body>
</html>